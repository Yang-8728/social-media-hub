# 视频标题自动生成功能

## 📝 标题格式

### 新格式：`ins海外离大谱#序号`
- 示例：`ins海外离大谱#84`
- 示例：`ins海外离大谱#85`
- 示例：`ins海外离大谱#86`

### 序号管理
- **当前序号**: 84
- **序号文件**: `data/episode_number.txt`
- **自动递增**: 每次上传后序号自动+1

## 🔧 实现机制

### 1. 序号存储
```plaintext
data/episode_number.txt
84  # 当前序号
```

### 2. 标题生成逻辑
```python
def _generate_title(self) -> str:
    current_number = self._get_next_episode_number()
    title = f"ins海外离大谱#{current_number}"
    return title
```

### 3. 序号自动递增
```python
def _get_next_episode_number(self) -> int:
    # 读取当前序号
    current_number = int(read_from_file())
    
    # 保存下一个序号
    write_to_file(current_number + 1)
    
    # 返回当前序号用于这次上传
    return current_number
```

## 📊 使用流程

### 第一次上传
1. 读取序号文件：`84`
2. 生成标题：`ins海外离大谱#84`
3. 更新序号文件：`85`

### 第二次上传
1. 读取序号文件：`85`
2. 生成标题：`ins海外离大谱#85`
3. 更新序号文件：`86`

### 依此类推...

## 🛡️ 容错机制

### 文件不存在
- 自动创建 `episode_number.txt`
- 默认从84开始

### 读取失败
- 使用默认序号84
- 显示警告信息

### 写入失败
- 仍然使用当前序号进行上传
- 下次可能重复序号（需要手动调整）

## 📁 文件说明

### `data/episode_number.txt`
- **作用**: 存储当前的集数序号
- **格式**: 纯数字，如 `84`
- **更新**: 每次上传后自动+1
- **备份**: 建议定期备份此文件

### Git忽略
```gitignore
# 动态序号文件（会自动更新）
data/episode_number.txt
```
该文件已添加到`.gitignore`，避免频繁的git提交。

## 🎯 使用示例

### 命令
```bash
python main.py --upload video.mp4 --ai_vanvan
```

### 预期结果
```
📝 标题已设置: ins海外离大谱#84
✅ 已选择分区: 小剧场
✅ 已选择子分区: 搞笑研究所
🎉 检测到'稿件投递成功'提示！
```

### 序号文件变化
```
上传前: 84
上传后: 85
```

## 🔮 未来扩展

### 多账号序号管理
```
data/episode_number_ai_vanvan.txt
data/episode_number_aigf8728.txt
```

### 序号重置功能
```bash
python main.py --reset-episode-number 100
```

### 自定义标题前缀
```bash
python main.py --upload video.mp4 --title-prefix "自定义前缀"
```

## ⚠️ 注意事项

1. **序号文件备份**: 定期备份 `episode_number.txt` 避免丢失
2. **手动调整**: 如果需要跳过某些序号，可以手动编辑文件
3. **并发上传**: 同时上传多个视频可能导致序号冲突
4. **错误恢复**: 上传失败时序号已经递增，需要手动回退
